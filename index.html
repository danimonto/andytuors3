<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Andy Tuors & Cia.</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f0;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
    }

    h1 {
      margin-top: 40px;
      font-size: 40px;
      color: #333;
      text-align: center;
    }

    .timer-settings {
      margin: 30px 0 10px;
    }

    .timer-settings input {
      padding: 6px;
      width: 60px;
      margin: 0 5px;
    }

    button {
      padding: 8px 16px;
      margin-left: 10px;
      cursor: pointer;
    }

    #countdown {
      font-size: 24px;
      margin-bottom: 20px;
      color: #333;
    }

    .multi-track {
      position: relative;
      width: 90%;
      max-width: 900px;
      background: transparent;
      margin-bottom: 40px;
    }

    .row {
      width: 100%;
      height: 60px;
      background: #ddd;
      border-radius: 30px;
      margin-bottom: 10px;
      position: relative;
      box-sizing: border-box;
    }

    .curve {
      position: absolute;
      width: 20px;
      height: 20px;
      background: #4caf50;
      border-radius: 50%;
      z-index: 1;
    }

    .runner {
      position: absolute;
      font-size: 30px;
      z-index: 10;
      transition: top 1s linear, left 1s linear, transform 0.2s;
    }

    .marker {
      position: absolute;
      top: -20px;
      font-size: 12px;
      color: #444;
    }
  </style>
</head>
<body>
  <h1>Andy Tuors & Cia.</h1>

  <div class="timer-settings">
    <label>Inicio:</label>
    <input type="number" id="startHour" min="0" max="23" value="9">:
    <input type="number" id="startMinute" min="0" max="59" value="0">
    <label>Fin:</label>
    <input type="number" id="endHour" min="0" max="23" value="17">:
    <input type="number" id="endMinute" min="0" max="59" value="0">
    <button onclick="startRun()">Iniciar</button>
  </div>

  <div id="countdown">00:00:00</div>

  <div class="multi-track" id="multiTrack"></div>

  <script>
    let countdownInterval;

    function startRun() {
      const countdownDisplay = document.getElementById('countdown');
      const trackContainer = document.getElementById('multiTrack');

      const startHour = parseInt(document.getElementById('startHour').value);
      const startMinute = parseInt(document.getElementById('startMinute').value);
      const endHour = parseInt(document.getElementById('endHour').value);
      const endMinute = parseInt(document.getElementById('endMinute').value);

      let startTime = new Date();
      let endTime = new Date();
      startTime.setHours(startHour, startMinute, 0);
      endTime.setHours(endHour, endMinute, 0);

      if (endTime <= startTime) return alert("El fin debe ser posterior al inicio");

      const totalSeconds = Math.floor((endTime - startTime) / 1000);
      const hours = Math.ceil(totalSeconds / 3600);

      clearInterval(countdownInterval);
      trackContainer.innerHTML = '';

      const rowHeight = 70;
      const trackWidth = trackContainer.offsetWidth - 60;

      for (let i = 0; i < hours; i++) {
        const row = document.createElement('div');
        row.className = 'row';

        const marker = document.createElement('div');
        marker.className = 'marker';
        marker.style.left = (i % 2 === 0 ? '10px' : (trackWidth - 20) + 'px');
        marker.style.top = '-20px';
        marker.innerText = `Hora ${i + 1}`;
        row.appendChild(marker);

        trackContainer.appendChild(row);
      }

      const startIcon = document.createElement('div');
      startIcon.innerText = '🪑';
      startIcon.style.position = 'absolute';
      startIcon.style.left = '10px';
      startIcon.style.top = '10px';
      trackContainer.appendChild(startIcon);

      const endIcon = document.createElement('div');
      endIcon.innerText = '🚗';
      endIcon.style.position = 'absolute';
      endIcon.style.right = '10px';
      endIcon.style.top = ((hours - 1) * rowHeight + 10) + 'px';
      trackContainer.appendChild(endIcon);

      const runner = document.createElement('div');
      runner.className = 'runner';
      runner.id = 'runner';
      runner.innerText = '🏃';
      runner.style.left = '10px';
      runner.style.top = '10px';
      runner.style.transform = 'scaleX(1)';
      trackContainer.appendChild(runner);

      countdownDisplay.textContent = formatTime(totalSeconds);
      let remaining = totalSeconds;
      countdownInterval = setInterval(() => {
        remaining--;
        countdownDisplay.textContent = formatTime(remaining);
        if (remaining === 5 * 60) alert("Vaya saludando");
        if (remaining <= 0) {
          clearInterval(countdownInterval);
          alert("Rajemos");
        }
      }, 1000);

      let currentLine = 0;
      let direction = 1;
      let segmentTime = totalSeconds / (hours * 2 - 1);

      function moveNext() {
        if (currentLine >= hours) return;
        const left = direction === 1 ? (trackWidth) : 0;
        const top = currentLine * rowHeight + 10;

        runner.style.transition = `left ${segmentTime}s linear, top ${segmentTime}s linear`;
        runner.style.left = left + 'px';
        runner.style.top = top + 'px';
        runner.style.transform = direction === 1 ? 'scaleX(1)' : 'scaleX(-1)';

        direction *= -1;
        currentLine++;

        if (currentLine < hours) {
          setTimeout(moveNext, segmentTime * 1000);
        }
      }

      setTimeout(moveNext, 500);
    }

    function formatTime(totalSeconds) {
      let hrs = Math.floor(totalSeconds / 3600);
      let mins = Math.floor((totalSeconds % 3600) / 60);
      let secs = totalSeconds % 60;
      return `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }
  </script>
</body>
</html>
